<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Makarios Emporium — Product</title>
<style>
  body { font-family: 'Inter', sans-serif; margin:0; padding:0; background:#fff; }
  .container { max-width:1100px; margin:1rem auto; padding:1rem; }
  .product-wrapper { display:flex; gap:2rem; flex-wrap:wrap; }
  .product-img { flex:1; min-width:250px; }
  .product-img img { width:100%; border-radius:10px; }
  .product-info { flex:1; min-width:250px; display:flex; flex-direction:column; gap:1rem; }
  .price { font-weight:700; color:#e53935; font-size:1.2rem; }
  .btn { background:#e53935; color:#fff; border:none; border-radius:8px; padding:0.8rem; cursor:pointer; font-weight:600; }
  .btn:disabled { background:#ccc; cursor:not-allowed; }

  /* Mobile */
  @media(max-width:768px){
    .product-wrapper { flex-direction:column; align-items:center; }
  }
</style>
<script type="module" src="../firebase.js"></script>
</head>
<body>
<div class="container" id="productContainer">
  <!-- Product details will be loaded dynamically -->
</div>

<script type="module">
import { db, doc, getDoc } from "../firebase.js";

const container = document.getElementById("productContainer");

// Get product ID from URL
const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get("id");

// Fetch product
const productRef = doc(db, "products", productId);
const productSnap = await getDoc(productRef);

if(productSnap.exists()){
  const p = productSnap.data();
  container.innerHTML = `
    <div class="product-wrapper">
      <div class="product-img"><img src="${p.imageUrl}" alt="${p.name}"></div>
      <div class="product-info">
        <h1>${p.name}</h1>
        <p class="price">₵${p.price}</p>
        <p>${p.description || "Premium clothing from Makarios Emporium."}</p>
        <label>Quantity: <input type="number" value="1" min="1" id="qtyInput"></label>
        <button class="btn" id="addToCartBtn">Add to Cart</button>
      </div>
    </div>
  `;
}

// Cart logic
const addBtn = document.getElementById("addToCartBtn");
addBtn.addEventListener("click", () => {
  const qty = parseInt(document.getElementById("qtyInput").value);
  let cart = JSON.parse(localStorage.getItem("cart") || "{}");
  if(cart[productId]) cart[productId] += qty;
  else cart[productId] = qty;
  localStorage.setItem("cart", JSON.stringify(cart));
  alert(`${qty} item(s) added to cart!`);
});
</script>
</body>
</html>
